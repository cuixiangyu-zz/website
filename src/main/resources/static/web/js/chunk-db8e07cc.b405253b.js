(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-db8e07cc"],{1689:function(t,e,i){},"1c47":function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return r}));var a=i("b775");function s(t){return Object(a["a"])({url:"/viewHistory/addHistory",method:"post",data:t})}function r(t){return Object(a["a"])({url:"/viewHistory/getHistory",method:"get",params:t})}},"299f":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"main"},[i("el-container",[i("el-header")],1),t._v(" "),i("el-row",{attrs:{type:"flex"}},[i("el-col",{attrs:{span:6,offset:6}},[i("el-card",[i("el-image",{key:t.tableData.id,attrs:{src:t.tableData.coverUrl,lazy:!0,fit:"fill"}})],1)],1),t._v(" "),i("el-col",{attrs:{span:6}},[i("el-row",{staticStyle:{bottom:"0px",top:"0px",right:"0px",left:"20px"}},[i("el-col",{attrs:{span:24}},[i("p",{staticStyle:{"font-size":"25px"}},[t._v(t._s(t.tableData.name))]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.getWatchList()}}},[t._v("播放列表")])],1),t._v(" "),i("el-col",{attrs:{span:24}},[i("div",{staticClass:"block"},[i("span",{staticClass:"demonstration"},[t._v("评分")]),t._v(" "),i("el-rate",{attrs:{colors:t.colors},on:{change:function(e){return t.changelevel(t.tableData)}},model:{value:t.level.level,callback:function(e){t.$set(t.level,"level",e)},expression:"level.level"}})],1),t._v(" "),i("div",{staticClass:"block"},[i("span",{staticClass:"demonstration"},[t._v("收藏")]),t._v(" "),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"添加收藏",placement:"right"}},[null==t.tableData.userFavorite?i("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-star-off"},on:{click:function(e){return t.addFavorite(t.tableData)}}}):t._e()],1),t._v(" "),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"取消收藏",placement:"right"}},[null!==t.tableData.userFavorite?i("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-star-on"},on:{click:function(e){return t.deleteFavorite(t.tableData)}}}):t._e()],1)],1)]),t._v(" "),i("el-col",{attrs:{span:24}},[i("p",{staticStyle:{"font-size":"17px"}},[t._v("作者")]),t._v(" "),t._l(t.tableData.actors,(function(e){return i("el-col",{key:e.id,staticClass:"row-li",attrs:{span:4},on:{click:function(i){return t.getActor(e.id)}}},[i("el-tag",[t._v(t._s(e.chineseName))])],1)}))],2),t._v(" "),i("el-col",{attrs:{span:24}},[i("p",{staticStyle:{"font-size":"17px",width:"20%"}},[t._v("分类")]),t._v(" "),t._l(t.tableData.types,(function(e){return i("el-col",{key:e.id,staticClass:"row-li",attrs:{span:4},on:{click:function(i){return t.getType(e)}}},[i("el-tag",[t._v(t._s(e.chineseName))])],1)}))],2)],1)],1)],1),t._v(" "),t._l(t.videos,(function(e){return i("el-row",{key:e.poster,staticStyle:{width:"60%",left:"20%"}},[i("div",{staticClass:"player-container"},[i("video-player",{staticClass:"vjs-custom-skin",attrs:{options:e},on:{keyup:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])?null:"button"in e&&0!==e.button?null:t.down(e)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"right",39,e.key,["Right","ArrowRight"])?null:"button"in e&&2!==e.button?null:t.up(e)}]}})],1)])})),t._v(" "),i("el-row",{staticStyle:{width:"60%",left:"20%"}}),t._v(" "),i("el-drawer",{attrs:{title:"播放列表!",visible:t.tableVisible,direction:"rtl",size:"50%"},on:{"update:visible":function(e){t.tableVisible=e}}},[i("el-table",{attrs:{data:t.videoAndIdList.videoList,height:"800","row-class-name":t.tableRowClassName}},[i("el-table-column",{attrs:{property:"name",label:"影片名",width:"250"}}),t._v(" "),i("el-table-column",{attrs:{prop:"type",label:"类型"}}),t._v(" "),i("el-table-column",{attrs:{prop:"actors",label:"作者"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.actors,(function(e){return i("div",[t._v(t._s(e.chineseName))])}))}}])}),t._v(" "),i("el-table-column",{attrs:{label:"封面"},scopedSlots:t._u([{key:"default",fn:function(t){return[i("img",{attrs:{src:t.row.coverUrl,width:"90%",height:"90%",alt:"封面"}})]}}])}),t._v(" "),i("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"mini"},on:{click:function(i){return t.selectVideo(e.$index,e.row)}}},[t._v("查看影片")]),t._v(" "),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(i){return t.deleteVideo(e.$index,e.row)}}},[t._v("删除")])]}}])})],1)],1),t._v(" "),i("el-container",[i("el-header")],1)],2)},s=[],r=(i("ac4d"),i("8a81"),i("ac6a"),i("a481"),i("818f")),o=i("1c47"),n=i("bc50"),l=(i("fda2"),i("451f"),{data:function(){return{tableData:[],querylist:[],querydata:null,tableVisible:!1,editableTabsValue:"",video:void 0,videos:[],listQuery:{pageNum:1,pageSize:10,actorName:null,pictureName:null,language:null,types:null},typeMap:"",actors:"",deviceDetail:null,imgSrc:"http://127.0.0.1:8081/website/resources/_MG_0138.jpg",url:"http://127.0.0.1:8081/website/resources/_MG_0138.jpg",level:{id:null,type:null,level:null},colors:["#99A9BF","#F7BA2A","#FF9900"],viewHistory:{type:null,videoId:null,startData:"",watchTime:""},addFavoriteParms:{type:null,videoId:null},videoAndIdList:{idList:[],videoList:[]}}},created:function(){this.viewHistory.startData=Date.now();var t=sessionStorage.getItem("videoAndIdList");null!==t&&void 0!==t&&""!==t&&(this.videoAndIdList=JSON.parse(t)),this.getDetil()},mounted:function(){this.video=this.$refs.video},updated:function(){this.video=this.$refs.video},beforeRouteLeave:function(t,e,i){sessionStorage.setItem("listQuery_video_detail",JSON.stringify(this.querydata)),sessionStorage.setItem("refresh_video_detail",!0),sessionStorage.setItem("videoAndIdList",JSON.stringify(this.videoAndIdList));var a=Date.now();this.viewHistory.watchTime=a-this.viewHistory.startData,this.viewHistory.startData=new Date(this.viewHistory.startData),this.saveViewHistory(),i()},methods:{getDetil:function(){var t=this,e=sessionStorage.getItem("listQuery_video_detail"),i=sessionStorage.getItem("refresh_video_detail");null!==e&&null!==i&&"true"===i&&(this.querydata=JSON.parse(e)),null!==this.$route.params.id&&void 0!==this.$route.params.id&&""!==this.$route.params.id&&(this.querydata=this.$route.params.id),this.viewHistory.videoId=this.querydata,this.videoAndIdList.idList.unshift(this.querydata),Object(r["b"])({id:this.querydata}).then((function(e){t.viewHistory.type=e.type,t.level.level=e.level,e.coverUrl=e.coverUrl.replace(/\\/g,"/"),t.tableData=e;var i=[],a=!0,s=!1,r=void 0;try{for(var o,n=e.address[Symbol.iterator]();!(a=(o=n.next()).done);a=!0){var l=o.value,u={playbackRates:[.7,1,1.5,2],autoplay:!1,controls:!0,preload:"auto",muted:!1,loop:!1,language:"zh-CN",aspectRatio:"16:9",fluid:!0,sources:[{src:l}],poster:e.coverUrl,width:document.documentElement.clientWidth,notSupportedMessage:"此视频暂无法播放，请稍后再试"};i.push(u)}}catch(c){s=!0,r=c}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}t.videos=i}))},saveViewHistory:function(){Object(o["a"])(this.viewHistory).then((function(t){}))},getType:function(t){event.stopPropagation();var e=[],i=[];e.push("allTypes"),e.push(t.id),i.push(e),this.listQuery.types=i,this.listQuery.actorName=null,console.log(this.listQuery),this.jump()},getActor:function(t){event.stopPropagation(),this.listQuery.actorName=t,this.listQuery.types=null,this.jump()},jump:function(){this.$router.push({path:"/video/index",name:"影片"})},showimg:function(){var t=[];t.push("http://127.0.0.1:8081/website/resources/_MG_0170.jpg"),t.push("http://127.0.0.1:8081/website/resources/_MG_0177.jpg"),this.srcList=t},up:function(){var t=this.video.currentTime;console.log(t),this.video.currentTime=t+120},down:function(){var t=this.video.currentTime;console.log(t),this.video.currentTime=t-120},changelevel:function(t){this.level.id=t.id,this.level.type=t.type,Object(r["a"])(this.level)},addFavorite:function(t){var e=this;this.addFavoriteParms.videoId=t.id,this.addFavoriteParms.type=t.type,Object(n["a"])(this.addFavoriteParms).then((function(t){e.tableData.userFavorite=t})).catch((function(t){e.getDetil()}))},deleteFavorite:function(t){var e=this;Object(n["b"])({id:this.tableData.userFavorite.id}).then((function(t){e.tableData.userFavorite=null})).catch((function(t){e.getDetil()}))},getWatchList:function(){var t=this;Object(r["c"])({idList:JSON.stringify(this.videoAndIdList.idList)}).then((function(e){e.forEach((function(t){1===t.type?t.type="日本影片":2===t.type?t.type="美国影片":3===t.type?t.type="动漫":4===t.type?t.type="小视频":5===t.type&&(t.type="图片")})),t.videoAndIdList.videoList=e,t.tableVisible=!0,console.log(t.videoAndIdList)}))},deleteVideo:function(t,e){for(var i=0;i<this.videoAndIdList.idList.length;i++)e.id===this.videoAndIdList.idList[i]&&(this.videoAndIdList.idList.splice(i,1),i--);this.getWatchList()},selectVideo:function(t,e){var i=this,a=Date.now();this.viewHistory.watchTime=a-this.viewHistory.startData,this.viewHistory.startData=new Date(this.viewHistory.startData),this.saveViewHistory(),this.viewHistory.startData=Date.now(),this.tableVisible=!1,this.querydata=e.id,Object(r["b"])({id:this.querydata}).then((function(t){i.viewHistory.type=t.type,i.level.level=t.level,i.tableData=t;var e=[],a=!0,s=!1,r=void 0;try{for(var o,n=t.address[Symbol.iterator]();!(a=(o=n.next()).done);a=!0){var l=o.value,u={playbackRates:[.7,1,1.5,2],autoplay:!1,controls:!0,preload:"auto",muted:!1,loop:!1,language:"zh-CN",aspectRatio:"16:9",fluid:!0,sources:[{src:l}],poster:t.coverUrl,width:document.documentElement.clientWidth,notSupportedMessage:"此视频暂无法播放，请稍后再试"};e.push(u)}}catch(c){s=!0,r=c}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}i.videos=e}))},tableRowClassName:function(t){var e=t.row;t.rowIndex;return e.id===this.querydata?"success-row":""}}}),u=l,c=(i("82b4"),i("2877")),d=Object(c["a"])(u,a,s,!1,null,null,null);e["default"]=d.exports},"818f":function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"a",(function(){return r})),i.d(e,"c",(function(){return o}));var a=i("b775");function s(t){return Object(a["a"])({url:"/video/getDetile",method:"get",params:t})}function r(t){return Object(a["a"])({url:"/video/changelevel",method:"get",params:t})}function o(t){return Object(a["a"])({url:"/video/getWatchList",method:"get",params:t})}},"82b4":function(t,e,i){"use strict";var a=i("1689"),s=i.n(a);s.a},bc50:function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return r})),i.d(e,"c",(function(){return o}));var a=i("b775");function s(t){return Object(a["a"])({url:"/userFavorite/addFavorite",method:"post",data:t})}function r(t){return Object(a["a"])({url:"/userFavorite/deleteFavorite",method:"get",params:t})}function o(t){return Object(a["a"])({url:"/userFavorite/getList",method:"get",params:t})}}}]);